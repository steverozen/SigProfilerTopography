<h1> Using SigProfilerTopography Output </h1>

----------

This section goes over the different directories and files that are generated when running SigProfilerTopography. The example directories throughout this section were generated from the [Quick Start Example][1].

@[toc](Quick Links)


# Output Overview #
The output directory `results/21BRCA_SPT` will contain subdirectories `data`, `figure`, `SPA`, and `logs`. Below is a preliminary view of the directories that will be generated in `results/21BRCA_SPT`.

![OutputHierarchy](https://osf.io/nrwsb/download =1441x350)


## data ##

Under the `data` directory, data files and subdirectories containing analysis specific data files are created while conducting topography analyses, and these files are used while plotting figures.

![OutputHierarchy](https://osf.io/v2hdw/download =1441x350)

### data files ###
*Table_SBS_Signature_Cutoff_NumberofMutations_AverageProbability.txt* is an exampler data file that contains all the information about the SBS mutational signatures considered in the topography analyses.

The main columns of the file include the following:
- jobname (here shown as cancer_type)
- signature
- cutoff
- number_of_mutations
- average_probability
- samples_list
- len(samples_list)
- len(all_samples_list)
- percentage_of_samples

Below is an example of what the file contains: 
![OutputHierarchy](https://osf.io/e5nhk/download =1441x350)


## figure ##

Under `figure` directory, there will be subdirectories for each topography analysis containing resulting plots. 

![OutputHierarchy](https://osf.io/jfbzp/download =1441x350)

To learn more about the contents of each of the subdirectories, refer to their corresponding sections:
<br>

Nucleosome Occupancy: [Output - Nucleosome Occupancy][2]
<br>
Replication Timing: [Output - Replication Timing][3]
<br>
Strand Asymmetry: [Output - Strand Asymmetry][4]
<br>
Epigenomics Occupancy: [Output - Epigenomics Analysis][5]
<br>
Strand-coordinated Mutagenesis (processivity): [Output - Strand-coordinated Mutagenesis][6]


## logs ##

Under `logs` directory, you will find the log files. An example of the layout of the `logs` directory is:

![OutputHierarchy](https://osf.io/5a2fg/download =1441x350)

## SPA ##

If you run SigProfilerTopography without providing probability matrices, SigProfilerTopography utilizes SigProfilerAssignment by default to attribute the activities of known reference mutational signatures from the Catalogue Of Somatic Mutations In Cancer (COSMIC) database to each examined sample. An example of the layout of the `SPA` directory is:

![OutputHierarchy](https://osf.io/2k4gf/download =1441x350)


# Output for SigProfilerTopography run with probability matrices #

However, if you run SigProfilerTopography with probability matrices, SigProfilerAssignment will not be executed. Therefore,  there won't be any `SPA` subdirectory. The output directory `results/21BRCA_SPT_with_probability_matrices` will contain subdirectories `data`, `figure`, and `logs`. Layout of these subdirectories will be the same.

![OutputHierarchy](https://osf.io/ts7bh/download =1441x350)


  [1]: https://osf.io/5unby/wiki/2.%20Quick%20Start%20Example/
  [2]: https://osf.io/5unby/wiki/5.%20Output%20-%20Nucleosome%20Occupancy/
  [3]: https://osf.io/5unby/wiki/6.%20Output%20-%20Replication%20Timing/
  [4]: https://osf.io/5unby/wiki/7.%20Output%20-%20Strand%20Asymmetry/
  [5]: https://osf.io/5unby/wiki/8.%20Output%20-%20Epigenomics%20Analysis/
  [6]: https://osf.io/5unby/wiki/9.%20Output%20-%20Strand-coordinated%20Mutagenesis/
